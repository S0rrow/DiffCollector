diff --git a/archiva-modules/archiva-web/archiva-webdav/src/main/java/org/apache/maven/archiva/webdav/ArchivaDavResource.java b/archiva-modules/archiva-web/archiva-webdav/src/main/java/org/apache/maven/archiva/webdav/ArchivaDavResource.java
index 846c7d6d5..7b94e7488 100644
--- a/archiva-modules/archiva-web/archiva-webdav/src/main/java/org/apache/maven/archiva/webdav/ArchivaDavResource.java
+++ b/archiva-modules/archiva-web/archiva-webdav/src/main/java/org/apache/maven/archiva/webdav/ArchivaDavResource.java
@@ -19,73 +19,35 @@
  * under the License.
  */
 
-import java.io.File;
-import java.io.FileInputStream;
-import java.io.FileOutputStream;
-import java.io.IOException;
-import java.util.ArrayList;
-import java.util.Calendar;
-import java.util.List;
-
-import javax.servlet.http.HttpServletResponse;
-
-import org.apache.commons.io.FileUtils;
-import org.apache.commons.io.IOUtils;
-import org.apache.jackrabbit.util.Text;
-import org.apache.jackrabbit.webdav.DavException;
-import org.apache.jackrabbit.webdav.DavResource;
-import org.apache.jackrabbit.webdav.DavResourceFactory;
-import org.apache.jackrabbit.webdav.DavResourceIterator;
-import org.apache.jackrabbit.webdav.DavResourceIteratorImpl;
-import org.apache.jackrabbit.webdav.DavResourceLocator;
-import org.apache.jackrabbit.webdav.DavServletResponse;
-import org.apache.jackrabbit.webdav.DavSession;
-import org.apache.jackrabbit.webdav.MultiStatusResponse;
+import org.apache.jackrabbit.webdav.*;
+import org.apache.jackrabbit.webdav.property.*;
 import org.apache.jackrabbit.webdav.io.InputContext;
 import org.apache.jackrabbit.webdav.io.OutputContext;
-import org.apache.jackrabbit.webdav.lock.ActiveLock;
-import org.apache.jackrabbit.webdav.lock.LockInfo;
-import org.apache.jackrabbit.webdav.lock.LockManager;
-import org.apache.jackrabbit.webdav.lock.Scope;
-import org.apache.jackrabbit.webdav.lock.Type;
-import org.apache.jackrabbit.webdav.property.DavProperty;
-import org.apache.jackrabbit.webdav.property.DavPropertyName;
-import org.apache.jackrabbit.webdav.property.DavPropertyNameSet;
-import org.apache.jackrabbit.webdav.property.DavPropertySet;
-import org.apache.jackrabbit.webdav.property.DefaultDavProperty;
-import org.apache.jackrabbit.webdav.property.ResourceType;
-import org.apache.maven.archiva.configuration.ManagedRepositoryConfiguration;
-import org.apache.maven.archiva.database.ArchivaAuditLogsDao;
-import org.apache.maven.archiva.model.ArchivaAuditLogs;
-import org.apache.maven.archiva.repository.audit.AuditEvent;
-import org.apache.maven.archiva.repository.audit.AuditListener;
-import org.apache.maven.archiva.scheduled.ArchivaTaskScheduler;
-import org.apache.maven.archiva.scheduled.tasks.RepositoryTask;
-import org.apache.maven.archiva.scheduled.tasks.TaskCreator;
-import org.apache.maven.archiva.webdav.util.IndexWriter;
+import org.apache.jackrabbit.webdav.lock.*;
+import org.apache.jackrabbit.util.Text;
+import org.apache.commons.io.IOUtils;
+import org.apache.commons.io.FileUtils;
 import org.apache.maven.archiva.webdav.util.MimeTypes;
-import org.codehaus.plexus.taskqueue.TaskQueueException;
+import org.apache.maven.archiva.webdav.util.IndexWriter;
 import org.joda.time.DateTime;
 import org.joda.time.format.DateTimeFormatter;
 import org.joda.time.format.ISODateTimeFormat;
-import org.slf4j.Logger;
-import org.slf4j.LoggerFactory;
 
-import java.io.File;
-import java.io.FileInputStream;
-import java.io.FileOutputStream;
-import java.io.IOException;
-import java.util.ArrayList;
-import java.util.List;
 import javax.servlet.http.HttpServletResponse;
+import java.util.List;
+import java.util.ArrayList;
+import java.io.*;
 
 /**
+ * @author <a href="mailto:james@atlassian.com">James William Dumay</a>
+ * Portions from the Apache Jackrabbit Project
  */
-public class ArchivaDavResource
-    implements DavResource
+public class ArchivaDavResource implements DavResource
 {
     public static final String HIDDEN_PATH_PREFIX = ".";
 
+    private final MimeTypes mimeTypes;
+
     private final ArchivaDavResourceLocator locator;
 
     private final DavResourceFactory factory;
@@ -94,61 +56,27 @@
 
     private final String logicalResource;
 
-    private DavPropertySet properties = null;
-
-    private LockManager lockManager;
-
-    private final DavSession session;
-
-    private String remoteAddr;
-
-    private final ManagedRepositoryConfiguration repository;
-
-    private final MimeTypes mimeTypes;
-
-    private List<AuditListener> auditListeners;
-
-    private String principal;
+    private static final String METHODS = "OPTIONS, GET, HEAD, POST, TRACE, PROPFIND, PROPPATCH, MKCOL, COPY, PUT, DELETE, MOVE";
 
-    public static final String COMPLIANCE_CLASS = "1, 2";
+    private static final String COMPLIANCE_CLASS = "1";
 
-    private ArchivaTaskScheduler scheduler;
+    private DavPropertySet properties;
 
-    private Logger log = LoggerFactory.getLogger( ArchivaDavResource.class );
-    
-    private ArchivaAuditLogsDao auditLogsDao;
+    private boolean propsInitialized = false;
 
-    public ArchivaDavResource( String localResource, String logicalResource, ManagedRepositoryConfiguration repository,
-                               DavSession session, ArchivaDavResourceLocator locator, DavResourceFactory factory,
-                               MimeTypes mimeTypes, List<AuditListener> auditListeners,
-                               ArchivaTaskScheduler scheduler, ArchivaAuditLogsDao auditLogsDao )
+    public ArchivaDavResource(String localResource, String logicalResource, MimeTypes mimeTypes, ArchivaDavResourceLocator locator, DavResourceFactory factory)
     {
-        this.localResource = new File( localResource );
+        this.mimeTypes = mimeTypes;
+        this.localResource = new File(localResource);
         this.logicalResource = logicalResource;
         this.locator = locator;
         this.factory = factory;
-        this.session = session;
-
-        // TODO: push into locator as well as moving any references out of the resource factory
-        this.repository = repository;
-
-        // TODO: these should be pushed into the repository layer, along with the physical file operations in this class
-        this.mimeTypes = mimeTypes;
-        this.auditListeners = auditListeners;
-        this.scheduler = scheduler;
-        this.auditLogsDao = auditLogsDao;
+        this.properties = new DavPropertySet();
     }
 
-    public ArchivaDavResource( String localResource, String logicalResource, ManagedRepositoryConfiguration repository,
-                               String remoteAddr, String principal, DavSession session, ArchivaDavResourceLocator locator,
-                               DavResourceFactory factory, MimeTypes mimeTypes, List<AuditListener> auditListeners,
-                               ArchivaTaskScheduler scheduler, ArchivaAuditLogsDao auditLogsDao )
+    public String getContentType()
     {
-        this( localResource, logicalResource, repository, session, locator, factory, mimeTypes, auditListeners,
-              scheduler, auditLogsDao );
-
-        this.remoteAddr = remoteAddr;
-        this.principal = principal;
+        return mimeTypes.getMimeType(localResource.getName());
     }
 
     public String getComplianceClass()
@@ -174,7 +102,7 @@ public boolean isCollection()
     public String getDisplayName()
     {
         String resPath = getResourcePath();
-        return ( resPath != null ) ? Text.getName( resPath ) : resPath;
+        return (resPath != null) ? Text.getName(resPath) : resPath;
     }
 
     public DavResourceLocator getLocator()
@@ -194,41 +122,44 @@ public String getResourcePath()
 
     public String getHref()
     {
-        return locator.getHref( isCollection() );
+        return locator.getHref(isCollection());
     }
 
     public long getModificationTime()
     {
+        initProperties();
         return localResource.lastModified();
     }
 
-    public void spool( OutputContext outputContext )
-        throws IOException
+    public long getContentLength()
     {
-        if ( !isCollection() )
-        {
-            outputContext.setContentLength( localResource.length() );
-            outputContext.setContentType( mimeTypes.getMimeType( localResource.getName() ) );
-        }
+        initProperties();
+        return localResource.length();
+    }
 
-        if ( !isCollection() && outputContext.hasStream() )
+    public void spool(OutputContext outputContext) throws IOException
+    {
+        if (!isCollection())
         {
-            FileInputStream is = null;
-            try
-            {
-                // Write content to stream
-                is = new FileInputStream( localResource );
-                IOUtils.copy( is, outputContext.getOutputStream() );
-            }
-            finally
-            {
-                IOUtils.closeQuietly( is );
-            }
+	    	FileInputStream is = null;
+	    	try
+	    	{
+	        	outputContext.setContentLength(getContentLength());
+				outputContext.setContentType(getContentType());
+		
+				//Write content to stream
+				is = new FileInputStream(localResource);
+				IOUtils.copy(is, outputContext.getOutputStream());
+	    	}
+	    	finally
+	    	{
+				IOUtils.closeQuietly(is);
+	    	}
         }
-        else if ( outputContext.hasStream() )
+        else
         {
-            IndexWriter writer = new IndexWriter( this, localResource, logicalResource );
-            writer.write( outputContext );
+            IndexWriter writer = new IndexWriter(this, localResource, logicalResource);
+            writer.write(outputContext);
         }
     }
 
@@ -237,35 +168,32 @@ public DavPropertyName[] getPropertyNames()
         return getProperties().getPropertyNames();
     }
 
-    public DavProperty getProperty( DavPropertyName name )
+    public DavProperty getProperty(DavPropertyName name)
     {
-        return getProperties().get( name );
+        initProperties();
+        return properties.get(name);
     }
 
     public DavPropertySet getProperties()
     {
-        return initProperties();
+        initProperties();
+        return properties;
     }
 
-    public void setProperty( DavProperty property )
-        throws DavException
+    public void setProperty(DavProperty property) throws DavException
     {
     }
 
-    public void removeProperty( DavPropertyName propertyName )
-        throws DavException
+    public void removeProperty(DavPropertyName propertyName) throws DavException
     {
     }
 
-    public MultiStatusResponse alterProperties( DavPropertySet setProperties, DavPropertyNameSet removePropertyNames )
-        throws DavException
+    public MultiStatusResponse alterProperties(DavPropertySet setProperties, DavPropertyNameSet removePropertyNames) throws DavException
     {
         return null;
     }
 
-    @SuppressWarnings( "unchecked" )
-    public MultiStatusResponse alterProperties( List changeList )
-        throws DavException
+    public MultiStatusResponse alterProperties(List changeList) throws DavException
     {
         return null;
     }
@@ -273,316 +201,215 @@ public MultiStatusResponse alterProperties( List changeList )
     public DavResource getCollection()
     {
         DavResource parent = null;
-        if ( getResourcePath() != null && !getResourcePath().equals( "/" ) )
-        {
-            String parentPath = Text.getRelativeParent( getResourcePath(), 1 );
-            if ( parentPath.equals( "" ) )
-            {
+        if (getResourcePath() != null && !getResourcePath().equals("/")) {
+            String parentPath = Text.getRelativeParent(getResourcePath(), 1);
+            if (parentPath.equals("")) {
                 parentPath = "/";
             }
-            DavResourceLocator parentloc = locator.getFactory().createResourceLocator( locator.getPrefix(),
-                                                                                       parentPath );
-            try
-            {
-                parent = factory.createResource( parentloc, session );
-            }
-            catch ( DavException e )
-            {
+            DavResourceLocator parentloc = locator.getFactory().createResourceLocator(locator.getPrefix(), parentPath);
+            try {
+                parent = factory.createResource(parentloc, null);
+            } catch (DavException e) {
                 // should not occur
             }
         }
         return parent;
     }
 
-    public void addMember( DavResource resource, InputContext inputContext )
-        throws DavException
+    public void addMember(DavResource resource, InputContext inputContext) throws DavException
     {
-        File localFile = new File( localResource, resource.getDisplayName() );
-        boolean exists = localFile.exists();
-
-        if ( isCollection() && inputContext.hasStream() ) // New File
+        File localFile = new File(localResource, resource.getDisplayName());
+        if (isCollection() && inputContext.hasStream()) //New File
         {
+            boolean deleteFile = false;
             FileOutputStream stream = null;
             try
             {
-                stream = new FileOutputStream( localFile );
-                IOUtils.copy( inputContext.getInputStream(), stream );
+                stream = new FileOutputStream(localFile);
+                IOUtils.copy(inputContext.getInputStream(), stream);
+                if (inputContext.getContentLength() != localFile.length())
+                {
+                    deleteFile = true;
+                    throw new DavException(HttpServletResponse.SC_BAD_REQUEST, "Content Header length was "
+                            + inputContext.getContentLength() + " but was " + localFile.length());
+                }
             }
-            catch ( IOException e )
+            catch (IOException e)
             {
-                throw new DavException( HttpServletResponse.SC_INTERNAL_SERVER_ERROR, e );
+                throw new DavException(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, e);
             }
             finally
             {
-                IOUtils.closeQuietly( stream );
-            }
-
-            // TODO: a bad deployment shouldn't delete an existing file - do we need to write to a temporary location first?
-            if ( inputContext.getContentLength() != localFile.length() )
-            {
-                FileUtils.deleteQuietly( localFile );
-
-                String msg =
-                    "Content Header length was " + inputContext.getContentLength() + " but was " + localFile.length();
-                log.debug( "Upload failed: " + msg );
-                throw new DavException( HttpServletResponse.SC_BAD_REQUEST, msg );
+                IOUtils.closeQuietly(stream);
+                if (deleteFile)
+                {
+                    FileUtils.deleteQuietly(localFile);
+                }
             }
-
-            queueRepositoryTask( localFile );
-
-            log.debug(
-                "File '" + resource.getDisplayName() + ( exists ? "' modified " : "' created " ) + "(current user '" +
-                    this.principal + "')" );
-
-            triggerAuditEvent( resource, exists ? AuditEvent.MODIFY_FILE : AuditEvent.CREATE_FILE );
         }
-        else if ( !inputContext.hasStream() && isCollection() ) // New directory
+        else if (!inputContext.hasStream() && isCollection()) //New directory
         {
             localFile.mkdir();
-
-            log.debug( "Directory '" + resource.getDisplayName() + "' (current user '" + this.principal + "')" );
-
-            triggerAuditEvent( resource, AuditEvent.CREATE_DIR );
         }
         else
         {
-            String msg = "Could not write member " + resource.getResourcePath() + " at " + getResourcePath() +
-                " as this is not a DAV collection";
-            log.debug( msg );
-            throw new DavException( HttpServletResponse.SC_BAD_REQUEST, msg );
+            throw new DavException(HttpServletResponse.SC_BAD_REQUEST, "Could not write member "
+                    + resource.getResourcePath() + " at " + getResourcePath());
         }
     }
 
     public DavResourceIterator getMembers()
     {
-        List<DavResource> list = new ArrayList<DavResource>();
-        if ( exists() && isCollection() )
+        ArrayList list = new ArrayList();
+        if (exists() && isCollection())
         {
-            for ( String item : localResource.list() )
+            for (String item : localResource.list())
             {
                 try
                 {
-                    if ( !item.startsWith( HIDDEN_PATH_PREFIX ) )
+                    if (!item.startsWith(HIDDEN_PATH_PREFIX))
                     {
                         String path = locator.getResourcePath() + '/' + item;
-                        DavResourceLocator resourceLocator = locator.getFactory().createResourceLocator(
-                            locator.getPrefix(), path );
-                        DavResource resource = factory.createResource( resourceLocator, session );
-
-                        if ( resource != null )
-                        {
-                            list.add( resource );
-                        }
-                        log.debug( "Resource '" + item + "' retrieved by '" + this.principal + "'" );
+                        DavResourceLocator resourceLocator = locator.getFactory().createResourceLocator(locator.getPrefix(), path);
+                        DavResource resource = factory.createResource(resourceLocator, null);
+                        if (resource != null) list.add(resource);
                     }
                 }
-                catch ( DavException e )
+                catch (DavException e)
                 {
-                    // Should not occur
+                    //Should not occur
                 }
             }
         }
-        return new DavResourceIteratorImpl( list );
+        return new DavResourceIteratorImpl(list);
     }
 
-    public void removeMember( DavResource member )
-        throws DavException
+    public void removeMember(DavResource member) throws DavException
     {
-        File resource = checkDavResourceIsArchivaDavResource( member ).getLocalResource();
+        File localResource = checkDavResourceIsArchivaDavResource(member).getLocalResource();
 
-        if ( resource.exists() )
+        if (!localResource.exists())
         {
-            try
-            {
-                if ( resource.isDirectory() )
-                {
-                    FileUtils.deleteDirectory( resource );
+            throw new DavException(HttpServletResponse.SC_NOT_FOUND, member.getResourcePath());
+        }
 
-                    triggerAuditEvent( member, AuditEvent.REMOVE_DIR );
-                }
-                else
-                {
-                    if ( !resource.delete() )
-                    {
-                        throw new IOException( "Could not remove file" );
-                    }
+        boolean suceeded = false;
 
-                    triggerAuditEvent( member, AuditEvent.REMOVE_FILE );
-                }
-                log.debug( ( resource.isDirectory() ? "Directory '" : "File '" ) + member.getDisplayName() +
-                    "' removed (current user '" + this.principal + "')" );
+        if (localResource.isDirectory())
+        {
+            try
+            {
+                FileUtils.deleteDirectory(localResource);
+                suceeded = true;
             }
-            catch ( IOException e )
+            catch (IOException e)
             {
-                throw new DavException( HttpServletResponse.SC_INTERNAL_SERVER_ERROR );
+                throw new DavException(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, e);
             }
         }
-        else
+
+        if (!suceeded && localResource.isFile())
         {
-            throw new DavException( HttpServletResponse.SC_NOT_FOUND );
+            suceeded = localResource.delete();
         }
-    }
 
-    private void triggerAuditEvent( DavResource member, String event )
-        throws DavException
-    {
-        String path = logicalResource + "/" + member.getDisplayName();
-        
-        triggerAuditEvent( checkDavResourceIsArchivaDavResource( member ).remoteAddr, locator.getRepositoryId(), path,
-                           event );
+        if (!suceeded)
+        {
+            throw new DavException(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, "Could not delete resource " + member.getResourcePath());
+        }
     }
 
-    public void move( DavResource destination )
-        throws DavException
+    public void move(DavResource destination) throws DavException
     {
-        if ( !exists() )
+        if (!exists())
         {
-            throw new DavException( HttpServletResponse.SC_NOT_FOUND, "Resource to copy does not exist." );
+            throw new DavException(HttpServletResponse.SC_NOT_FOUND, "Resource to copy does not exist.");
         }
 
         try
         {
-            ArchivaDavResource resource = checkDavResourceIsArchivaDavResource( destination );
-            if ( isCollection() )
+            ArchivaDavResource localResource = checkDavResourceIsArchivaDavResource(destination);
+            if (isCollection())
             {
-                FileUtils.moveDirectory( getLocalResource(), resource.getLocalResource() );
-
-                triggerAuditEvent( remoteAddr, locator.getRepositoryId(), logicalResource, AuditEvent.MOVE_DIRECTORY );
+                FileUtils.moveDirectory(getLocalResource(), localResource.getLocalResource());
             }
             else
             {
-                FileUtils.moveFile( getLocalResource(), resource.getLocalResource() );
-
-                triggerAuditEvent( remoteAddr, locator.getRepositoryId(), logicalResource, AuditEvent.MOVE_FILE );
+                FileUtils.moveFile(getLocalResource(), localResource.getLocalResource());
             }
-
-            log.debug( ( isCollection() ? "Directory '" : "File '" ) + getLocalResource().getName() + "' moved to '" +
-                destination + "' (current user '" + this.principal + "')" );
         }
         catch ( IOException e )
         {
-            throw new DavException( HttpServletResponse.SC_INTERNAL_SERVER_ERROR, e );
+            throw new DavException(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, e);
         }
     }
 
-    public void copy( DavResource destination, boolean shallow )
-        throws DavException
+    public void copy(DavResource destination, boolean shallow) throws DavException
     {
-        if ( !exists() )
+        if (!exists())
         {
-            throw new DavException( HttpServletResponse.SC_NOT_FOUND, "Resource to copy does not exist." );
+            throw new DavException(HttpServletResponse.SC_NOT_FOUND, "Resource to copy does not exist.");
         }
 
-        if ( shallow && isCollection() )
+        if (shallow && isCollection())
         {
-            throw new DavException( DavServletResponse.SC_FORBIDDEN, "Unable to perform shallow copy for collection" );
+            throw new DavException(DavServletResponse.SC_FORBIDDEN, "Unable to perform shallow copy for collection");
         }
 
         try
         {
-            ArchivaDavResource resource = checkDavResourceIsArchivaDavResource( destination );
-            if ( isCollection() )
+            ArchivaDavResource localResource = checkDavResourceIsArchivaDavResource(destination);
+            if (isCollection())
             {
-                FileUtils.copyDirectory( getLocalResource(), resource.getLocalResource() );
-
-                triggerAuditEvent( remoteAddr, locator.getRepositoryId(), logicalResource, AuditEvent.COPY_DIRECTORY );
+                FileUtils.copyDirectory(getLocalResource(), localResource.getLocalResource());
             }
             else
             {
-                FileUtils.copyFile( getLocalResource(), resource.getLocalResource() );
-
-                triggerAuditEvent( remoteAddr, locator.getRepositoryId(), logicalResource, AuditEvent.COPY_FILE );
+                FileUtils.copyFile(getLocalResource(), localResource.getLocalResource());
             }
-            log.debug( ( isCollection() ? "Directory '" : "File '" ) + getLocalResource().getName() + "' copied to '" +
-                destination + "' (current user '" + this.principal + "')" );
         }
-        catch ( IOException e )
+        catch ( IOException e)
         {
-            throw new DavException( HttpServletResponse.SC_INTERNAL_SERVER_ERROR, e );
+            throw new DavException(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, e);
         }
     }
 
-    public boolean isLockable( Type type, Scope scope )
+    public boolean isLockable(Type type, Scope scope)
     {
-        return Type.WRITE.equals( type ) && Scope.EXCLUSIVE.equals( scope );
+        return false;
     }
 
-    public boolean hasLock( Type type, Scope scope )
+    public boolean hasLock(Type type, Scope scope)
     {
-        return getLock( type, scope ) != null;
+        return false;
     }
 
-    public ActiveLock getLock( Type type, Scope scope )
+    public ActiveLock getLock(Type type, Scope scope)
     {
-        ActiveLock lock = null;
-        if ( exists() && Type.WRITE.equals( type ) && Scope.EXCLUSIVE.equals( scope ) )
-        {
-            lock = lockManager.getLock( type, scope, this );
-        }
-        return lock;
+        return null;
     }
 
     public ActiveLock[] getLocks()
     {
-        ActiveLock writeLock = getLock( Type.WRITE, Scope.EXCLUSIVE );
-        return ( writeLock != null ) ? new ActiveLock[]{writeLock} : new ActiveLock[0];
+        return new ActiveLock[0];
     }
 
-    public ActiveLock lock( LockInfo lockInfo )
-        throws DavException
+    public ActiveLock lock(LockInfo reqLockInfo) throws DavException
     {
-        ActiveLock lock = null;
-        if ( isLockable( lockInfo.getType(), lockInfo.getScope() ) )
-        {
-            lock = lockManager.createLock( lockInfo, this );
-        }
-        else
-        {
-            throw new DavException( DavServletResponse.SC_PRECONDITION_FAILED, "Unsupported lock type or scope." );
-        }
-        return lock;
+        return null;
     }
 
-    public ActiveLock refreshLock( LockInfo lockInfo, String lockToken )
-        throws DavException
+    public ActiveLock refreshLock(LockInfo reqLockInfo, String lockToken) throws DavException
     {
-        if ( !exists() )
-        {
-            throw new DavException( DavServletResponse.SC_NOT_FOUND );
-        }
-        ActiveLock lock = getLock( lockInfo.getType(), lockInfo.getScope() );
-        if ( lock == null )
-        {
-            throw new DavException( DavServletResponse.SC_PRECONDITION_FAILED,
-                                    "No lock with the given type/scope present on resource " + getResourcePath() );
-        }
-
-        lock = lockManager.refreshLock( lockInfo, lockToken, this );
-
-        return lock;
+        return null;
     }
 
-    public void unlock( String lockToken )
-        throws DavException
+    public void unlock(String lockToken) throws DavException
     {
-        ActiveLock lock = getLock( Type.WRITE, Scope.EXCLUSIVE );
-        if ( lock == null )
-        {
-            throw new DavException( HttpServletResponse.SC_PRECONDITION_FAILED );
-        }
-        else if ( lock.isLockedByToken( lockToken ) )
-        {
-            lockManager.releaseLock( lockToken, this );
-        }
-        else
-        {
-            throw new DavException( DavServletResponse.SC_LOCKED );
-        }
     }
 
-    public void addLockManager( LockManager lockManager )
+    public void addLockManager(LockManager lockmgr)
     {
-        this.lockManager = lockManager;
     }
 
     public DavResourceFactory getFactory()
@@ -592,117 +419,52 @@ public DavResourceFactory getFactory()
 
     public DavSession getSession()
     {
-        return session;
+        return null;
     }
 
     /**
      * Fill the set of properties
      */
-    protected DavPropertySet initProperties()
-    {
-        if ( !exists() )
-        {
-            properties = new DavPropertySet();
-        }
-
-        if ( properties != null )
-        {
-            return properties;
+    protected void initProperties() {
+        if (!exists() || propsInitialized) {
+            return;
         }
 
-        DavPropertySet properties = new DavPropertySet();
-
         // set (or reset) fundamental properties
-        if ( getDisplayName() != null )
-        {
-            properties.add( new DefaultDavProperty( DavPropertyName.DISPLAYNAME, getDisplayName() ) );
+        if (getDisplayName() != null) {
+            properties.add(new DefaultDavProperty(DavPropertyName.DISPLAYNAME, getDisplayName()));
         }
-        if ( isCollection() )
-        {
-            properties.add( new ResourceType( ResourceType.COLLECTION ) );
+        if (isCollection()) {
+            properties.add(new ResourceType(ResourceType.COLLECTION));
             // Windows XP support
-            properties.add( new DefaultDavProperty( DavPropertyName.ISCOLLECTION, "1" ) );
-        }
-        else
-        {
-            properties.add( new ResourceType( ResourceType.DEFAULT_RESOURCE ) );
+            properties.add(new DefaultDavProperty(DavPropertyName.ISCOLLECTION, "1"));
+        } else {
+            properties.add(new ResourceType(ResourceType.DEFAULT_RESOURCE));
 
             // Windows XP support
-            properties.add( new DefaultDavProperty( DavPropertyName.ISCOLLECTION, "0" ) );
+            properties.add(new DefaultDavProperty(DavPropertyName.ISCOLLECTION, "0"));
         }
 
-        // Need to get the ISO8601 date for properties
-        DateTime dt = new DateTime( localResource.lastModified() );
+        //Need to get the ISO8601 date for properties
+        DateTime dt = new DateTime(localResource.lastModified());
         DateTimeFormatter fmt = ISODateTimeFormat.dateTime();
-        String modifiedDate = fmt.print( dt );
-
-        properties.add( new DefaultDavProperty( DavPropertyName.GETLASTMODIFIED, modifiedDate ) );
+        String modifiedDate = fmt.print(dt);
 
-        properties.add( new DefaultDavProperty( DavPropertyName.CREATIONDATE, modifiedDate ) );
+        properties.add(new DefaultDavProperty(DavPropertyName.GETLASTMODIFIED, modifiedDate));
 
-        properties.add( new DefaultDavProperty( DavPropertyName.GETCONTENTLENGTH, localResource.length() ) );
+        properties.add(new DefaultDavProperty(DavPropertyName.CREATIONDATE, modifiedDate));
 
-        this.properties = properties;
+        properties.add(new DefaultDavProperty(DavPropertyName.GETCONTENTLENGTH, localResource.length()));
 
-        return properties;
+        propsInitialized = true;
     }
 
-    private ArchivaDavResource checkDavResourceIsArchivaDavResource( DavResource resource )
-        throws DavException
+    private ArchivaDavResource checkDavResourceIsArchivaDavResource(DavResource resource) throws DavException
     {
-        if ( !( resource instanceof ArchivaDavResource ) )
-        {
-            throw new DavException( HttpServletResponse.SC_INTERNAL_SERVER_ERROR,
-                                    "DavResource is not instance of ArchivaDavResource" );
-        }
-        return (ArchivaDavResource) resource;
-    }
-
-    private void triggerAuditEvent( String remoteIP, String repositoryId, String resource, String action )
-    {
-        AuditEvent event = new AuditEvent( repositoryId, principal, resource, action );
-        event.setRemoteIP( remoteIP );
-
-        for ( AuditListener listener : auditListeners )
-        {
-            listener.auditEvent( event );
-        }
-        
-        // identify as artifact deployment/upload
-        if( action.equals( AuditEvent.CREATE_FILE ) )
-        {
-            action = AuditEvent.UPLOAD_FILE;
-        }
-        
-        String user = principal;
-        if( principal == null )
-        {
-            user = "guest";
-        }
-        
-        ArchivaAuditLogs auditLogs = new ArchivaAuditLogs();
-        auditLogs.setArtifact( resource );
-        auditLogs.setEvent( action );
-        auditLogs.setEventDate( Calendar.getInstance().getTime() );
-        auditLogs.setRepositoryId( repositoryId );
-        auditLogs.setUsername( user );
-        
-        auditLogsDao.saveAuditLogs( auditLogs );
-    }
-
-    private void queueRepositoryTask( File localFile )
-    {
-        RepositoryTask task = TaskCreator.createRepositoryTask( repository.getId(), localFile, false, true );
-        
-        try
-        {
-            scheduler.queueRepositoryTask( task );
-        }
-        catch ( TaskQueueException e )
+        if (!(resource instanceof ArchivaDavResource))
         {
-            log.error(
-                "Unable to queue repository task to execute consumers on resource file ['" + localFile.getName() +
-                    "']." );
+            throw new DavException(HttpServletResponse.SC_INTERNAL_SERVER_ERROR, "DavResource is not instance of ArchivaDavResource");
         }
+        return (ArchivaDavResource)resource;
     }
 }